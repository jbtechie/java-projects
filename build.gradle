apply plugin: 'groovy'
apply plugin: 'shadow'

buildscript {
  repositories {
    jcenter()
  }

  dependencies {
    classpath 'com.github.jengelman.gradle.plugins:shadow:0.8'
  }
}

repositories {
  mavenCentral()
  mavenRepo(name: "JQuery", url: "http://code.jquery.com") {
    pattern = "[module]-[revision](.[classifier]).[ext]"
  }
//  mavenRepo(name:"gRaphael", url: "https://raw.github.com/DmitryBaranovskiy/g.raphael/master/min") {
//    pattern = "module-(.[classifier]).[ext]"
//  }
}

configurations {
  js
}

dependencies {
  compile 'org.codehaus.groovy:groovy-all:2.2.1'
  compile 'com.yammer.dropwizard:dropwizard-core:0.6.2'
  compile 'com.yammer.dropwizard:dropwizard-views:0.6.2'
  compile 'com.sun.jersey:jersey-client:1.17.1'
  compile 'com.google.inject:guice:3.0'
  compile 'com.google.inject.extensions:guice-grapher:3.0'
  compile 'com.netflix.rxjava:rxjava-groovy:0.15.1'

  compile 'org.elasticsearch:elasticsearch:1.0.1'
  // required by Groovy runtime reflection in ElasticSearch
  compile 'com.vividsolutions:jts:1.12'

  testCompile 'junit:junit:4.10'

  js group: 'jquery', name: 'jquery', version: '1.6.4', classifier: 'min', ext: "js"
//  js name: 'g.raphael', version: '0.51', classifier: 'min', ext: "js"

}

task libs(type: Sync) {
  from configurations.runtime
  into "build/libs"
}

task fetchJs(type: Copy) {
  from configurations.js
  into "$buildDir/resources/assets/js"
}

shadow {
  exclude 'META-INF/*.DSA'
  exclude 'META-INF/*.RSA'
}

version = '0.1'

jar {
  manifest {
    attributes 'Main-Class': 'com.compuality.dropwizard.MainService'
  }
}
